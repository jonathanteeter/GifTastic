<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="assets/css/style.css">
    <title>AJAX Homework</title>
</head>
<body>

    <header>Click each button for animal fun:</header>

    <div id='animalButtons'></div>
    <div id='images'></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript">

        var topics = ["Flamingos", "Hippos", "Lemurs", "Camels", "Honey Badgers", "Hyenas", "Monkeys", "Llamas", "Anteaters", "Sloths", "Toucans", "Goats", "Armadillo", "Pinguin"];

        $(document).ready(function(){

            
            for(var i = 0; i < topics.length; i++) {
                
                // create html element
                var buttonName = $("<buttons>");

                buttonName.attr('button', (topics[i]))
                buttonName.attr('id', 'animal-button')
                buttonName.addClass('btn')
                buttonName.addClass('animal-buttons')
                buttonName.text(topics[i])

                console.log(topics[i])

                // add button to page
                $("#animalButtons").append(buttonName) 
            }
  
            $(".animal-buttons").on("click", function() {
                
                // Get var
                var selectedAnimal = $(this).attr("button");
                console.log("Button selected is: " + selectedAnimal);
                //  NO WORKIE:
                // var button_text = $('#animal-button').text();
                // console.log(button_text);
   
                // ~ var button_text = document.getElementById('#animal-button').innerHTML;

                var baseUrl = 'https://api.giphy.com/v1/gifs/search?q=';
                var userinput = selectedAnimal;
                var key = '&api_key=xhZaqFQHadxdfwECPk3PnrH9Km1XVPnO&limit=10';
                var queryURL = baseUrl + userinput + key;

                console.log(queryURL);

                // Making an AJAX call to the queryURL using jQuery
                $.ajax({
                    url: queryURL,
                    method: "GET"
                })

                // Run function after AJAX call when API returns data
                .then(function(response) {

                    for(var j = 0; j < response.data.length; j++) {

                        // Creating and storing a div tag
                        var animalDiv = $("<div>");

                        // Creating a paragraph tag with the result item's rating
                        var p = $("<p>").text("Rating is: " + ratingURL);

                        // Define variables that provide the Rating & image URL, both still and animated
                        var ratingURL = response.data[j].rating;
                        var stillImageURL = response.data[j].images.fixed_height_still.url;
                        var animateImageURL = response.data[j].images.fixed_height.url
                        console.log("Rating is: ", ratingURL);
                        console.log("Image URL is: ", animateImageURL);

                        // Creating and storing an image tag
                        var animalImage = $("<img>");

                        // Setting the src attribute of the image to a property pulled off the result item
                        animalImage.attr("src", animateImageURL);
                        animalImage.attr("alt", userinput);
                        
                        // Appending the paragraph and image tag to the animalDiv
                        animalDiv.append(p);
                        animalDiv.append(animalImage);
                        
                        // Add animal images to the #images div
                        $("#images").prepend(animalDiv);

                    }
                });
            });
        })

    </script>
    
    <script>src="assets/javascript/animaze.js"</script>
    
</body>
</html>